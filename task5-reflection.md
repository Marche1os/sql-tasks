Мое решение выглядит проще, быстрее для реализации и выразительно для стандартных сценариев. 
Но потребуется доработать деления на 0 и остерегаться эффекта N+1 запросов из-за многочисленных подзапросов на каждую метрику.

Эталонное решение выглядит профессиональнее, мощнее и расширяемее, отлично подходит для аналитической системы, где требуется поддержка сложных метрик и минимизация повторных операций при больших данных.

Оба решения рабочие, действительно отражают типичные стили построения SQL-аналитики: мое решение более простое из-за простых подзапросов и предложенный вариант через поэтапную обработку данных. 
Простой SELECT - это скорость и понятность, но он умеет меньше и хуже работает при росте таблиц. 
Многоуровневый WITH позволяет наращивать мощь и устойчивость запроса, но требует больше времени на поддержку.

