Подводя итог всех заданий и этого - было трудно уместить в голове всю схему данных, ранее с довольно большими схемами не сталкивался, поэтому поначалу не очень понимал как с этим работать.
Не уверен в правильности своего решения, особенно ввиду отсутствия понимания значений в полях таблиц. Поэтому были некоторые допущения в формулах расчета.

Из плюсов отмечу, что узнал много нового в построении больших запросов с большим количеством выборок, CTE, алиасы полей/таблиц, встроенные функции для аггрегировании, формат выдачи в виде JSON и т.п.

Сравнивать решения сложно ввиду допущений, для учебных целей просмотр эталонного решения показывает, что для расчетов включено больше параметров, что дает более точный ответ.
Если не вдаваться в детали формул и расчетов - в целом, мое решение схоже с эталонным, хотя по объему эталон значительно выше:)

В последнее время на работе стал чаще работать с SQL и данными и получаю инсайты, как такие SQL запросы улучшают думание в терминах данных и как получать знания из данных, используя такие расчеты.
