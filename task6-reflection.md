Когда я сравнил своё решение с примером, первое, что бросилось в глаза - более строгая и структурированная работа с данными через CTE в образце. 
Я увидел, что разбивка на логические блоки (ремесленники, материалы, продукция) помогает избежать дублирования, сделать запрос прозрачнее и контролируемей. 
В своём варианте я пытался сделать всё одним махом, из-за чего рисковал получить дубликаты строк и запутаться в агрегации.

Я понял, что у меня пока не хватает аккуратности в вопросах соединений: иногда присоединяю сразу все нужные таблицы без дополнительных предагрегаций в CTE, 
что чревато мультипликативностью и искажением итоговых метрик. 
Особенно это касается расчёта корреляций и сложных показателей эффективности, где легко ошибиться из-за ненужных повторов.

Взяв для анализа оба подхода, я пришёл к выводу, что стоит обращать больше внимания на логику расчёта промежуточных метрик, отдельно работать со скиллами и корректно определять диапазоны активности цехов - это база для честного сравнения цехов между собой. 
Также осознал, что любую работу с датами нужно продумывать по типам и понимать, откуда считается начало отсчёта.

Помимо технических нюансов, для себя отметил важность явных и подробных комментариев к каждому участку кода - без них поддерживать сложный SQL-запрос становится тяжело даже спустя неделю после написания.

В целом, я почувствовал, что сделал шаг вперёд в понимании и структурировании SQL-запросов, но мне стоит больше времени уделять отделению разных логик по слоям, чтобы в будущем писать масштабируемые и хорошо проверяемые запросы. 
Пример научил меня ещё большему почтению к модульности и аккуратности в аналитике.
